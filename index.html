<html>
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Irakli Gozalishvili">
    <link rel=stylesheet href=../CodeMirror/lib/codemirror.css>
    <link rel=stylesheet href=../CodeMirror/theme/ambiance.css>
    <script src=../CodeMirror/lib/codemirror.js></script>
    <script src=../CodeMirror/mode/markdown/markdown.js></script>
    <script src=../CodeMirror/mode/javascript/javascript.js></script>
    <script src=../CodeMirror/mode/clojure/clojure.js></script>
    <script src=../CodeMirror/mode/coffeescript/coffeescript.js></script>
    <script src=./plugins/code-mirror/prose.js></script>
    <style>
      html, body {
        font-size: 12px;
        margin: 0;
        padding: 0;
        top: 0;
        left: 0;
        width: 100%;
        min-width: 100%;
        height: 100%;
        min-height: 100%;
        color: #E6E1DC;
        overflow: hidden;
      }

      .CodeMirror .CodeMirror-scroll {
        height: 100%;
      }
    </style>
  </head>
  <body class=ambiance>
<textarea id="input" name="input">
# Core

Since core module of prose is mainly designed to work with process pipes
it makes use of nodejs's core modules:

    #!/usr/bin/env javascript
    var Module = require("module").Module;
    var path = require("path");

In order to handle [markdown][] a full featured markdown parser written in JS
[marked][] is used.

    var marked = require("marked");

Only thing this module does is takes input from the process standard input
an writes compiled version to the standard output.

    #!/usr/bin/env clojure
    (defn main
      []
      (if (< (count process.argv) 3)
        (do
          (.resume process.stdin)
          (.set-encoding process.stdin)
          (compile process.stdin process.stdout (.cwd process)))
        (._load Module (.resolve path (get process.argv 2)) nil true)))


If module is executed as a program, it automatically invokes it's `main`
function:

    #!/usr/bin/env coffeescript
    main() if require.main is module


[markdown]:http://daringfireball.net/projects/markdown
[marked]:https://github.com/chjj/marked
</textarea>
    <div id=gcli-display></div>
    <input id=gcli-input class=gcli-input type=text autofocus/>
    <script>
      var input = CodeMirror.fromTextArea(document.getElementById("input"), {
        lineNumbers: false,
        autoClearEmptyLines: true,
        tabSize: 2,
        indentWithTabs: false,
        electricChars: true,
        autoClearEmptyLines: true,
        theme: "ambiance",
        mode: "prose",
        autofocus: true,
        fixedGutter: true,
        matchBrackets: true,
        onFocus: function() {
          document.getElementById('gcli-display').hidden = true
        },
        onBlur: function() {
          document.getElementById('gcli-display').hidden = false
        },
        onCursorActivity: function() {
          input.setLineClass(hlLine, null, null);
          hlLine = input.setLineClass(input.getCursor().line, null, "activeline");
        },
        onGutterClick: function() {
          var output = document.getElementById("output")
          var input = document.getElementById("input")
          output.hidden = !output.hidden
          input.style.width = output.hidden ? '100%' : '50%'
        }
      });
      var hlLine = input.setLineClass(0, null, "activeline");
    </script>
  </body>
</html>
